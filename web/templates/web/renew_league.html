{% extends "web/base.html" %}

{% block title %}Renew League - {{ league.name }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8 max-w-2xl">
    <h1 class="text-4xl font-bold mb-6">Renew League</h1>
    
    {% if messages %}
        {% for message in messages %}
            <div class="mb-4 p-4 rounded-lg {% if message.tags %}bg-{{ message.tags }}-100 text-{{ message.tags }}-800{% else %}bg-blue-100 text-blue-800{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    
    <!-- Current League Summary -->
    <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-6 mb-6 border-l-4 border-blue-500">
        <h2 class="text-2xl font-semibold mb-4 text-gray-900 dark:text-white">Current League</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-700 dark:text-gray-300">
            <div>
                <p class="font-semibold">League Name:</p>
                <p class="text-lg">{{ league.name }}</p>
            </div>
            <div>
                <p class="font-semibold">Status:</p>
                <p class="text-lg">{% if league.is_active %}Active{% else %}Archived{% endif %}</p>
            </div>
            <div>
                <p class="font-semibold">Teams:</p>
                <p class="text-lg">{{ league.teams.count }} teams</p>
            </div>
            <div>
                <p class="font-semibold">Roster Format:</p>
                <p class="text-lg">{{ league.get_roster_format_display }}</p>
            </div>
            <div>
                <p class="font-semibold">Commissioner:</p>
                <p class="text-lg">{{ league.commissioner.username }}</p>
            </div>
            <div>
                <p class="font-semibold">Max Teams:</p>
                <p class="text-lg">{{ league.max_teams }}</p>
            </div>
        </div>
    </div>
    
    <!-- What Will Be Renewed -->
    <div class="bg-blue-50 dark:bg-blue-900 rounded-lg p-6 mb-6 border border-blue-200">
        <h3 class="text-xl font-semibold mb-3 text-blue-900 dark:text-blue-100">✓ What Will Be Renewed</h3>
        <ul class="space-y-2 text-blue-800 dark:text-blue-200">
            <li class="flex items-start">
                <span class="text-green-600 mr-2">✓</span>
                <span><strong>All league settings:</strong> Format, roster sizes, scoring rules, playoff structure</span>
            </li>
            <li class="flex items-start">
                <span class="text-green-600 mr-2">✓</span>
                <span><strong>New league name:</strong> "{{ league.name }} - {{ next_season }}"</span>
            </li>
            <li class="flex items-start">
                <span class="text-green-600 mr-2">✓</span>
                <span><strong>Fresh rosters:</strong> Teams will be empty, ready for new drafts</span>
            </li>
            <li class="flex items-start">
                <span class="text-green-600 mr-2">✓</span>
                <span><strong>Team owners invited:</strong> All previous members will be invited to join</span>
            </li>
            <li class="flex items-start">
                <span class="text-green-600 mr-2">✓</span>
                <span><strong>Stats reset:</strong> All scores, waivers, and trades start fresh</span>
            </li>
        </ul>
    </div>
    
    <!-- What Will NOT Change -->
    <div class="bg-amber-50 dark:bg-amber-900 rounded-lg p-6 mb-6 border border-amber-200">
        <h3 class="text-xl font-semibold mb-3 text-amber-900 dark:text-amber-100">ℹ️ What Will NOT Change</h3>
        <ul class="space-y-2 text-amber-800 dark:text-amber-200">
            <li class="flex items-start">
                <span class="text-gray-500 mr-2">•</span>
                <span>Old league will remain archived (still visible in your league history)</span>
            </li>
            <li class="flex items-start">
                <span class="text-gray-500 mr-2">•</span>
                <span>All historical stats and scores are preserved</span>
            </li>
            <li class="flex items-start">
                <span class="text-gray-500 mr-2">•</span>
                <span>You will remain commissioner of the new league</span>
            </li>
        </ul>
    </div>
    
    <!-- Renewal Form -->
    <form method="post" class="bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700">
        {% csrf_token %}
        
        <div class="mb-6">
            <h3 class="text-lg font-semibold mb-4 text-gray-900 dark:text-white">Confirm Renewal</h3>
            
            <div class="flex items-start">
                <input type="checkbox" name="confirm_renewal" id="confirm_renewal" required
                       class="mt-1 w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-2 focus:ring-blue-500 cursor-pointer">
                <label for="confirm_renewal" class="ml-3 text-gray-700 dark:text-gray-300">
                    I confirm I want to renew <strong>{{ league.name }}</strong> for <strong>{{ next_season }}</strong> 
                    with all current settings and team members
                </label>
            </div>
            
            {% if form.confirm_renewal.errors %}
                <div class="mt-2 text-red-600 dark:text-red-400">
                    {{ form.confirm_renewal.errors.0 }}
                </div>
            {% endif %}
        </div>
        
        <div class="flex gap-3">
            <button type="submit" class="flex-1 px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition duration-200">
                ✓ Renew League for {{ next_season }}
            </button>
            <a href="{% url 'league_detail' league.id %}" class="flex-1 px-6 py-3 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white font-semibold rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition duration-200 text-center">
                Cancel
            </a>
        </div>
    </form>
    
    <!-- Info Box -->
    <div class="mt-8 p-4 bg-blue-100 dark:bg-blue-900 border border-blue-300 dark:border-blue-700 rounded-lg">
        <p class="text-blue-900 dark:text-blue-100">
            <strong>Need help?</strong> After renewing, you'll create a new draft with your members, or assign players manually. 
            All your league settings and scoring rules will remain the same!
        </p>
    </div>
</div>
{% endblock %}
